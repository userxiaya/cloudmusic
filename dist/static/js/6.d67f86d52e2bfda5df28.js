webpackJsonp([6],{"3aRB":function(s,t){},SVp0:function(s,t){},r6iy:function(s,t,e){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=e("4YfN"),a=e.n(i),r=e("0tE7"),n=e("/Nq/"),o=e("9rMa"),c=e("KgXo"),l=e("gPkE"),h={data:function(){return{songs:[],limit:30,page:1,suggest:{},haveMore:!1,searchShow:!0,searching:!1}},props:{query:{type:String,default:""}},components:{loading:c.a},mounted:function(){},watch:{query:function(s){if(""===s)return this.suggest={},this.songs=[],void(this.haveMore=!1);this.suggest={},this.songs=[],this.searchShow=!0,this.page=1,this.haveMore=!0,this.search()}},methods:{search:function(){var s=this;this.searchShow=!1,this.haveMore=!0,this.searching=!0,Object(n.c)(this.query,this.page).then(function(t){if(t.data.result.songs){var e=[];t.data.result.songs.forEach(function(s){e.push(Object(l.c)(s))}),s.songs=e,s.searching=!1}else s.haveMore=!1}).catch(function(t){s.searching=!1}),this.page+=this.limit,Object(n.d)(this.query).then(function(t){s.suggest=t.data.result})},searchMore:function(){var s=this;this.haveMore&&this.songs.length&&Object(n.c)(this.query,this.page).then(function(t){var e=t.data.result.songs;if(t.data.result.songs){var i=[];e.forEach(function(s){i.push(Object(l.c)(s))}),s.songs=s.songs.concat(i),s.$emit("refresh"),s.page+=s.limit}else s.haveMore=!1})},songDetail:function(s){var t={id:s.id,image:s.coverImgUrl,title:s.name,playCount:s.playCount,trackCount:s.trackCount};this.$emit("songDetail",t)},selectItem:function(s){this.$emit("selectItem",s)},singerDetail:function(s){var t={id:s.id,image:s.img1v1Url,title:s.name};this.$emit("singerDetail",t)}}},u={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{staticClass:"search-result",style:{"pointer-events":"auto"}},[e("div",{staticClass:"suggest"},[!s.searchShow&&s.query&&s.songs.length>0?e("div",{staticClass:"search-suggest"},[e("p",{staticClass:"title"},[s._v("最佳匹配")]),s._v(" "),s.suggest.artists&&s.suggest.artists[0]?e("div",{staticClass:"search-suggest-item",on:{click:function(t){t.stopPropagation(),s.singerDetail(s.suggest.artists[0])}}},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:s.suggest.artists[0].img1v1Url,expression:"suggest.artists[0].img1v1Url"}],key:s.suggest.artists[0].img1v1Url,attrs:{width:"50",height:"50"}}),s._v(" "),e("span",[s._v("歌手："+s._s(s.suggest.artists[0].name))])]):s._e(),s._v(" "),s.suggest.playlists&&s.suggest.playlists[0]?e("div",{staticClass:"search-suggest-item",on:{click:function(t){t.stopPropagation(),s.songDetail(s.suggest.playlists[0])}}},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:s.suggest.playlists[0].coverImgUrl,expression:"suggest.playlists[0].coverImgUrl"}],key:s.suggest.playlists[0].coverImgUrl,attrs:{width:"50",height:"50"}}),s._v(" "),e("div",{staticClass:"text"},[e("p",[s._v("歌单："+s._s(s.suggest.playlists[0].name))]),s._v(" "),s.suggest.albums&&s.suggest.albums[0]?e("p",{staticClass:"singer"},[s._v(s._s(s.suggest.albums[0].artist.name))]):s._e()])]):s._e()]):s._e(),s._v(" "),e("ul",{staticClass:"suggest-list"},[s._l(s.songs,function(t,i){return e("li",{key:i,staticClass:"suggest-item",on:{click:function(e){e.stopPropagation(),s.selectItem(t)}}},[s._m(0,!0),s._v(" "),e("div",{staticClass:"name"},[e("p",{staticClass:"song"},[s._v(s._s(t.name))]),s._v(" "),e("p",{staticClass:"singer"},[s._v(s._s(t.singer))])])])}),s._v(" "),e("div",{staticClass:"loading"},[(s.songs.length>=s.limit||s.searching)&&s.haveMore&&s.query?e("loading"):s._e()],1)],2),s._v(" "),e("div",{staticClass:"no-result-wrapper",staticStyle:{display:"none"}},[s._v("\n            抱歉，暂无搜索结果\n        ")])])])},staticRenderFns:[function(){var s=this.$createElement,t=this._self._c||s;return t("div",{staticClass:"icon"},[t("i")])}]};var g=e("C7Lr")(h,u,!1,function(s){e("SVp0")},"data-v-9e432c2a",null).exports,v={data:function(){return{query:"",hots:[],height:"",pt:""}},computed:a()({},Object(o.b)(["currentSong","searchHistoryList"])),mounted:function(){var s=this,t=screen.height-this.$refs.header.clientHeight;this.currentSong.id&&(this.pt="60px"),this.height=t+"px",Object(n.q)().then(function(t){if(t.data&&t.data.code+""=="200"){var e=t.data.result;s.hots=e.hots}})},methods:a()({},Object(o.c)({playBySong:"PLAYBYSONG",saveSearchHistory:"SAVESEARCHHISTORY",setSearchHistory:"SET_SEARCHHISTORY"}),{setSearch:function(s){this.query=s,this.saveSearchHistory(s)},searchMore:function(){this.$refs.suggest.searchMore()},songDetail:function(s){this.$refs.input.blur(),this.saveSearchHistory(this.query),this.$router.push({name:"songDetail",params:s})},singerDetail:function(s){this.saveSearchHistory(s.title),this.$router.push({name:"singerDetail",params:s})},selectItem:function(s){if(this.$refs.input.blur(),this.saveSearchHistory(this.query),this.currentSong.id&&this.currentSong.id+""==s.id+"")this.$bus.emit("player-show");else{var t=s;this.playBySong({self:this,song:t})}},clear:function(){this.query=""}}),components:{scroll:r.a,searchList:g},watch:{"currentSong.id":function(s){s&&(this.pt="60px")}}},p={render:function(){var s=this,t=s.$createElement,e=s._self._c||t;return e("div",{ref:"searchWrapper",staticClass:"search"},[e("div",{directives:[{name:"immersed1",rawName:"v-immersed1"}],ref:"header",staticClass:"head"},[e("div",{staticClass:"back iconfont",on:{click:function(t){t.stopPropagation(),s.$router.go(-1)}}}),s._v(" "),e("input",{directives:[{name:"model",rawName:"v-model",value:s.query,expression:"query"}],ref:"input",attrs:{type:"text",placeholder:"搜索歌曲，歌手"},domProps:{value:s.query},on:{input:function(t){t.target.composing||(s.query=t.target.value)}}}),s._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:this.query,expression:"this.query"}],staticClass:"close iconfont",on:{click:function(t){return t.stopPropagation(),s.clear(t)}}})]),s._v(" "),e("scroll",{ref:"scroll",style:{width:"100%",height:s.height,overflow:"hidden"},attrs:{pullup:!0},on:{scrollToEnd:s.searchMore}},[e("div",{style:{width:"100%",height:"auto","padding-bottom":s.pt}},[e("div",{directives:[{name:"show",rawName:"v-show",value:!s.query,expression:"!query"}],staticClass:"search-hots",staticStyle:{"pointer-events":"auto"}},[e("p",{staticClass:"title"},[s._v("热门搜索")]),s._v(" "),s._l(s.hots,function(t){return e("span",{key:t.first,staticClass:"search-hots-item",on:{click:function(e){e.stopPropagation(),s.setSearch(t.first)}}},[s._v("\n          "+s._s(t.first)+"\n        ")])})],2),s._v(" "),e("div",{directives:[{name:"show",rawName:"v-show",value:!s.query,expression:"!query"}],staticClass:"search-history"},[e("h1",{directives:[{name:"show",rawName:"v-show",value:s.searchHistoryList.length>0,expression:"searchHistoryList.length>0"}],staticClass:"title"},[e("span",{staticClass:"text"},[s._v("搜索历史")]),s._v(" "),e("span",{staticClass:"clear",on:{click:function(t){t.stopPropagation(),s.setSearchHistory([])}}},[e("i",{staticClass:"icon-clear iconfont"})])]),s._v(" "),e("div",{staticClass:"search-list"},[e("ul",s._l(s.searchHistoryList,function(t,i){return e("li",{key:i,staticClass:"search-item",on:{click:function(e){e.stopPropagation(),s.setSearch(t)}}},[e("span",{staticClass:"text"},[s._v(s._s(t))]),s._v(" "),e("span",{staticClass:"icon"},[e("i",{staticClass:"icon-delete iconfont"})])])}))])]),s._v(" "),e("searchList",{directives:[{name:"show",rawName:"v-show",value:s.query,expression:"query"}],ref:"suggest",attrs:{query:s.query},on:{singerDetail:s.singerDetail,songDetail:s.songDetail,selectItem:s.selectItem}})],1)])],1)},staticRenderFns:[]};var d=e("C7Lr")(v,p,!1,function(s){e("3aRB")},"data-v-4bfba856",null);t.default=d.exports}});
//# sourceMappingURL=6.d67f86d52e2bfda5df28.js.map