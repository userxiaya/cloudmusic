webpackJsonp([2],{"6bp2":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=i("4YfN"),s=i.n(r),n=i("aA9S"),a=i.n(n),c=function(t){for(var e=/\[(\d{2,}):(\d{2})(?:\.(\d{2,3}))?]/g,i=t.split("\n"),r=[],s=0;s<i.length;s++){var n=i[s],a=e.exec(n);if(a){var c=n.replace(e,"").trim();c&&r.push({time:60*a[1]*1e3+1e3*a[2]+((a[3]||0)>=100?1*(a[3]||0):10*(a[3]||0)),txt:c})}}return r.sort(function(t,e){return t.time-e.time}),r},o=i("/Nq/"),l=i("9rMa"),u={data:function(){return{touch:{initiated:!1},progressBtnWidth:0,progressStyle:{},percent:0}},methods:{progressTouchStart:function(t){this.touch.initiated=!0,this.touch.startX=t.touches[0].pageX,this.touch.left=this.$refs.progress.clientWidth},progressTouchMove:function(t){if(this.touch.initiated){this.triggerPercent();var e=t.touches[0].pageX-this.touch.startX,i=Math.min(Math.min(this.$refs.progressBar.clientWidth-this.progressBtnWidth,Math.max(0,this.touch.left+e)));this.offset(i)}},progressTouchEnd:function(t){this.touch.initiated=!1;var e=this.$refs.progressBar.clientWidth-this.progressBtnWidth,i=this.$refs.progress.clientWidth/e;this.$emit("percentChangeEnd",i)},triggerPercent:function(){var t=this.$refs.progressBar.clientWidth-this.progressBtnWidth,e=this.$refs.progress.clientWidth/t;this.$emit("percentChange",e)},offset:function(t){var e={width:t+"px",transform:"translate3d("+t+"px, 0, 0)"};this.progressStyle=e}},mounted:function(){this.progressBtnWidth=this.$refs.progressBtn2.clientWidth},props:{duration:{type:Number,default:function(){return 0}},position:{type:Number,default:function(){return 0}}},filters:{time:function(t){var e=(t|=0)%60;return e<10&&(e="0"+e),(t/60|0)+":"+e}},watch:{position:function(t){t+""===0?(this.percent=0,this.offset(0)):this.percent=t/this.duration},percent:function(t){if(t>=0&&!this.touch.initiated){var e=t*(this.$refs.progressBar.clientWidth-this.progressBtnWidth);this.offset(e)}}}},p={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"progress-wrapper"},[i("div",{staticClass:"time time-l"},[t._v(t._s(t._f("time")(t.position)))]),t._v(" "),i("div",{ref:"progressBar",staticClass:"progress-bar-wrapper"},[i("div",{staticClass:"progress-bar"},[i("div",{staticClass:"bar-inner"},[i("div",{ref:"progress",staticClass:"progress",style:{width:t.progressStyle.width}}),t._v(" "),i("div",{ref:"progressBtn",staticClass:"progress-btn-wrapper",style:{transform:t.progressStyle.transform},on:{touchstart:function(e){return e.preventDefault(),t.progressTouchStart(e)},touchmove:function(e){return e.preventDefault(),t.progressTouchMove(e)},touchend:function(e){return e.preventDefault(),t.progressTouchEnd(e)}}},[i("div",{ref:"progressBtn2",staticClass:"progress-btn"})])])])]),t._v(" "),i("div",{staticClass:"time time-r"},[t._v(t._s(t._f("time")(t.duration)))])])},staticRenderFns:[]};var d={data:function(){return{}},components:{bar:i("C7Lr")(u,p,!1,function(t){i("kOiF")},"data-v-db67ab42",null).exports},props:{duration:{type:Number,default:function(){return 0}},position:{type:Number,default:function(){return 0}}},methods:{changeMode:function(){3===this.playMode?(this.$store.state.playMode=1,window.localStorage.setItem("playMode",1)):(this.$store.state.playMode=this.playMode+1,window.localStorage.setItem("playMode",this.$store.state.playMode))},seekTo:function(t){this.$emit("percentChangeEnd",t)},nextSong:function(){this.$bus.emit("add-next-song",{self:this})},prevSong:function(){this.$bus.emit("add-prev-song",{self:this})}},computed:s()({},Object(l.b)(["playing"]),Object(l.d)(["playMode"]),{playModeClass:function(){var t="liebiaoxunhuan";switch(this.playMode){case 2:t="suijibofang";break;case 3:t="danquxunhuan";break;default:t="liebiaoxunhuan"}return t}})},h={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"bottom"},[t._m(0),t._v(" "),i("bar",{attrs:{duration:t.duration,position:t.position},on:{percentChangeEnd:t.seekTo}}),t._v(" "),i("div",{staticClass:"btn-box2"},[i("div",{class:"iconfont "+t.playModeClass+"-btn",on:{click:t.changeMode}}),t._v(" "),i("div",{staticClass:"last-btn iconfont",on:{click:function(e){return e.stopPropagation(),t.prevSong(e)}}}),t._v(" "),i("div",{class:t.playing?"pause-btn iconfont":"play-btn iconfont",on:{click:function(e){e.stopPropagation(),t.$bus.emit("set-play-state",!t.playing)}}}),t._v(" "),i("div",{staticClass:"next-btn iconfont",on:{click:function(e){return e.stopPropagation(),t.nextSong(e)}}}),t._v(" "),i("div",{staticClass:"caidan-btn iconfont",on:{click:function(e){e.stopPropagation(),t.$bus.emit("show-playlist")}}})])],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"btn_list"},[e("div",{staticClass:"like-btn iconfont"}),this._v(" "),e("div",{staticClass:"pinglun-btn iconfont hasNum"},[e("div",{staticClass:"num"},[this._v("999+")])]),this._v(" "),e("div",{staticClass:"more-btn iconfont"})])}]};var f=i("C7Lr")(d,h,!1,function(t){i("bYXj")},"data-v-e740d56c",null).exports,g=i("0tE7"),v={data:function(){return{top:0,lyricLine:[],lrcIndexCopy:0}},props:{lrc:{type:Array,default:function(){return{}}},nolrc:{type:Boolean,default:!1},lryempty:{type:Boolean,default:!1}},components:{scroll:g.a},methods:{singTo:function(t){try{this.$refs.scroll.scrollTo(0,-(this.lyricLine[t].offsetTop-this.top),1e3)}catch(t){}}},computed:s()({},Object(l.b)(["playerObj"]),{lrcIndex:function(){var t=this.playerObj.position?1e3*this.playerObj.position:0,e=this.lrc,i=0;if(e.length>0&&t>e[e.length-1].time)return i=e.length-1;for(var r=0;r<e.length;r++)if(e[r+1]&&t>=e[r].time&&t<e[r+1].time){i=r;break}return i}}),watch:{lrcIndex:function(t){this.lrcIndexCopy=t,this.singTo(t)},lrc:function(){var t=this;this.lrcIndexCopy=0,this.$nextTick(function(){t.$refs.scroll&&(t.$refs.scroll.scrollTo(0,0,0),t.lyricLine=t.$refs.lyricLine||[],t.lyricLine.length>0&&(t.top=t.lyricLine[0].offsetTop,setTimeout(function(){t.$refs.scroll.scrollTo(0,-(t.lyricLine[t.lrcIndex].offsetTop-t.top),0)},0)))})}}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticStyle:{width:"100%",height:"100%"}},[t.nolrc?i("scroll",{attrs:{click:!0}},[i("div",{staticClass:"lyric-wrapper"},[i("div",{staticClass:"lyric"},[i("p",{staticClass:"loading-lyric",staticStyle:{"pointer-events":"auto"}},[t._v("纯音乐无歌词")])])])]):t.lrc&&t.lrc.length>0?i("scroll",{ref:"scroll",attrs:{data:t.lrc,click:!0}},[i("div",{staticClass:"lyric-wrapper"},[i("div",{staticClass:"lyric"},t._l(t.lrc,function(e,r){return i("div",{key:e.time,ref:"lyricLine",refInFor:!0,class:t.lrcIndex===r?"item active":"item"},[e.text1?i("div",{staticClass:"p"},[t._v(t._s(e.text1))]):t._e(),t._v(" "),e.text2?i("div",{staticClass:"p"},[t._v(t._s(e.text2))]):t._e()])}))])]):i("scroll",{attrs:{click:!0}},[i("div",{staticClass:"lyric-wrapper"},[i("div",{staticClass:"lyric"},[i("p",{staticClass:"loading-lyric",staticStyle:{"pointer-events":"auto"}},[t._v(t._s(t.lryempty?"暂无歌词,叫爸爸就给加":"歌词加载中..."))])])])])],1)},staticRenderFns:[]};var y=i("C7Lr")(v,m,!1,function(t){i("DPsE")},"data-v-401b4d58",null).exports,b={props:{playType:{type:String,default:function(){return"pause"}},picUrl:{type:String,default:function(){return""}}},computed:s()({},Object(l.b)(["currentSong"]))},C={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"box"},[e("div",{staticClass:"middle-l"},[e("div",{staticClass:"cd-wrapper"},[e("div",{class:"cd play "+this.playType},[e("img",{directives:[{name:"lazy",rawName:"v-lazy",value:this.currentSong.image,expression:"currentSong.image"}],key:this.currentSong.image,staticClass:"image"})])])])])},staticRenderFns:[]};var _=i("C7Lr")(b,C,!1,function(t){i("H469")},"data-v-30949c58",null).exports,S={data:function(){return{currentShow:"cd",isMounted:!1,lrcFlags:!1,lrcData:[],lryempty:!1,nolrc:!1}},computed:s()({},Object(l.b)(["playerObj","currentSong"]),Object(l.d)(["playerShowFlag"])),props:{playType:{type:String,default:function(){return"pause"}},currentMusic:{type:Object,default:function(){return{}}}},components:{bottom:f,circleBox:_,lrc:y},mounted:function(){this.isMounted=!0},methods:{back:function(){this.$bus.emit("player-hide")},getLyric:function(t){var e=this;this.nolrc=!1,this.lryempty=!1,Object(o.k)(t).then(function(t){var i=t.data;if(i){var r={},s=[];if(i.nolyric+""=="true"&&(e.nolrc=!0),i.lrc&&i.lrc.lyric)c(i.lrc.lyric).forEach(function(t){var e={text1:t.txt};r[t.time+""]=e});else e.lryempty=!0;if(i.tlyric&&i.tlyric.lyric)c(i.tlyric.lyric).forEach(function(t){var e={text2:t.txt};r[t.time+""]&&(r[t.time+""]=a()(r[t.time+""],e))});for(var n in r){var o=r[n];o.time=n,s.push(o)}e.lrcData=s}}).catch(function(t){})},changeMiddle:function(){"cd"===this.currentShow?this.currentShow="lyric":this.currentShow="cd"},seekTo:function(t){this.$emit("percentChangeEnd",t)}},watch:{lrcData:function(t){},"currentSong.id":function(t){this.lrcData=[],"lyric"===this.currentShow&&this.getLyric(t),!1===this.playerShowFlag&&(this.lrcFlags=!1,this.currentShow="cd")},currentShow:function(t){"lyric"===t&&(this.lrcFlags=!0,0===this.lrcData.length&&this.getLyric(this.currentSong.id))},playerShowFlag:function(t){!1===t&&(this.currentShow="cd")}}},w={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{directives:[{name:"show",rawName:"v-show",value:t.isMounted,expression:"isMounted"}],staticClass:"main"},[i("div",{staticClass:"background"},[i("div",{staticClass:"filter"}),t._v(" "),i("img",{attrs:{width:"100%",height:"100%",src:t.currentMusic.pic}})]),t._v(" "),i("div",{staticClass:"top"},[i("div",{staticClass:"back",on:{click:function(e){return e.stopPropagation(),t.back(e)}}},[i("i",{staticClass:"fa iconfont"})]),t._v(" "),i("h1",{staticClass:"title"},[t._v(t._s(t.currentMusic.name))]),t._v(" "),i("h2",{staticClass:"subtitle"},t._l(t.currentMusic.artist,function(e,r){return i("span",{key:r,on:{click:function(e){e.stopPropagation(),t.$emit("singerclick")}}},[r<t.currentMusic.artist.length-1?[t._v(t._s(e.name)+"/")]:[t._v(t._s(e.name))]],2)}))]),t._v(" "),i("div",{staticClass:"middle",on:{click:t.changeMiddle}},[i("transition",{attrs:{name:"middleL"}},["cd"===t.currentShow&&!0===t.playerShowFlag?i("circleBox",{staticClass:"middlel",attrs:{picUrl:t.currentMusic.image||"",playType:t.playType}}):t._e()],1),t._v(" "),i("transition",{attrs:{name:"middleR"}},[t.lrcFlags?i("lrc",{directives:[{name:"show",rawName:"v-show",value:"lyric"===t.currentShow,expression:"currentShow === 'lyric'"}],staticClass:"middle-r",attrs:{lrc:"lyric"===t.currentShow&&!0===t.playerShowFlag?t.lrcData:[],nolrc:t.nolrc,lryempty:t.lryempty}}):t._e()],1)],1),t._v(" "),i("bottom",{attrs:{duration:t.playerObj.duration,position:t.playerObj.position},on:{percentChangeEnd:t.seekTo}})],1)},staticRenderFns:[]};var x=i("C7Lr")(S,w,!1,function(t){i("M06J")},"data-v-a138bb06",null).exports,k=i("wSez"),M={data:function(){return{slideName:"up",popupVisible:!1,currentMusic:{duration:0,position:0,image:"",name:"",artist:[]},artistList:[]}},components:{musicBox:x,Popup:k.Popup,Cell:k.Cell,scroll:g.a},computed:s()({},Object(l.b)(["currentSong","playing","musicList"]),Object(l.d)(["playerShowFlag"])),mounted:function(){var t=this.currentMusic;for(var e in this.currentMusic)t[e]=this.currentSong[e]},methods:{seekTo:function(t){this.$bus.emit("add-seek-to",{precent:t})},selectSinger:function(t){var e=this;this.popupVisible=!1,this.slideName="",this.$nextTick(function(){e.$bus.emit("player-hide");var i={id:t.id,image:t.singerImage,title:t.name};e.$bus.emit("singer-detail-acrive",{params:i}),e.$router.push({name:"singerDetail",params:i})})},showSinger:function(){var t=this.currentSong.artistNew;t&&t.length>0?1===t.length?this.selectSinger(t[0]):this.popupVisible=!0:this.toast("繁忙，请稍后再试")}},watch:{currentSong:{handler:function(t){var e=this.currentMusic;for(var i in this.currentMusic)e[i]=t[i]},deep:!0},musicList:function(t){0===t.length&&!0===this.playerShowFlag&&this.$bus.emit("player-hide")},playerShowFlag:function(t){!0===t&&(this.slideName="up")}},activated:function(){this.slideName="up"}},$={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("transition",{attrs:{name:t.slideName}},[i("div",{staticClass:"main"},[i("popup",{staticStyle:{"border-radius":"5px","padding-bottom":"30px","padding-top":"10px"},model:{value:t.popupVisible,callback:function(e){t.popupVisible=e},expression:"popupVisible"}},[i("h2",[t._v("请选择要查看的歌手")]),t._v(" "),i("scroll",{staticClass:"singer-box",attrs:{data:t.currentSong.artistNew,stopPropagation:!0}},[i("div",{staticStyle:{width:"100%",height:"auto"}},t._l(t.currentSong.artistNew,function(e,r){return i("div",{key:r,on:{click:function(i){i.stopPropagation(),t.selectSinger(e)}}},[i("cell",{staticClass:"cell",attrs:{title:e.name}},[i("img",{directives:[{name:"lazy",rawName:"v-lazy",value:e.singerImage,expression:"item.singerImage"}],key:e.singerImage,staticStyle:{"border-radius":"5px","margin-right":"20px"},attrs:{slot:"icon",width:"auto",height:"60"},slot:"icon"})])],1)}))])],1),t._v(" "),i("musicBox",{directives:[{name:"immersed",rawName:"v-immersed"}],attrs:{currentMusic:t.currentMusic,playType:t.playing?"play":"pause"},on:{singerclick:t.showSinger,percentChangeEnd:t.seekTo}})],1)])},staticRenderFns:[]};var T=i("C7Lr")(M,$,!1,function(t){i("b4cT")},"data-v-410a5c2e",null);e.default=T.exports},DPsE:function(t,e){},H469:function(t,e){},M06J:function(t,e){},b4cT:function(t,e){},bYXj:function(t,e){},kOiF:function(t,e){}});
//# sourceMappingURL=2.44b90b48613a2cf05ce4.js.map